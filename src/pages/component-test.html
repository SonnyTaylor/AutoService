<section class="page" data-page="component-test">
  <h1>Component Test</h1>
  <p class="muted">Camera, microphone, speakers, keyboard, mouse/trackpad, network, and display tests.</p>

  <nav class="subtabs" role="tablist" aria-label="Component sections">
    <button role="tab" id="tab-camera" data-tab="camera" aria-selected="true" tabindex="0">Camera</button>
  <button role="tab" id="tab-audio" data-tab="audio" aria-selected="false" tabindex="-1">Audio</button>
    <button role="tab" id="tab-keyboard" data-tab="keyboard" aria-selected="false" tabindex="-1">Keyboard</button>
    <button role="tab" id="tab-mouse" data-tab="mouse" aria-selected="false" tabindex="-1">Mouse</button>
    <button role="tab" id="tab-network" data-tab="network" aria-selected="false" tabindex="-1">Network</button>
    <button role="tab" id="tab-display" data-tab="display" aria-selected="false" tabindex="-1">Display</button>
  </nav>

  <!-- Camera Test -->
  <section class="card subtab-panel" id="panel-camera" role="tabpanel" aria-labelledby="tab-camera">
    <h2 id="camera-title">Camera</h2>
    <div class="row">
      <label for="camera-select">Camera:</label>
      <select id="camera-select" class="device-select" aria-label="Select camera"></select>
      <button id="camera-start">Start</button>
      <button id="camera-stop" disabled>Stop</button>
      <span id="camera-status" class="muted" role="status" aria-live="polite"></span>
    </div>
    <div class="media-row">
      <video id="camera-video" playsinline autoplay muted></video>
    </div>
  </section>

  <!-- Audio Test -->
  <section class="card subtab-panel" id="panel-audio" role="tabpanel" aria-labelledby="tab-audio" hidden>
    <h2 id="audio-title">Audio</h2>
    <div class="grid grid-2">
      <div>
        <h3>Microphone</h3>
        <div class="row wrap device-row">
          <label for="mic-select">Input:</label>
          <select id="mic-select" class="device-select" aria-label="Select microphone"></select>
          <button id="mic-start">Start</button>
          <button id="mic-stop" disabled>Stop</button>
          <label class="muted" style="display:flex;align-items:center;gap:6px"><input type="checkbox" id="mic-monitor"> Monitor</label>
        </div>
        <div class="stat-grid">
          <div class="stat"><div class="label">Level (RMS)</div><div class="value" id="mic-kpi-level">— dB</div></div>
          <div class="stat"><div class="label">Peak</div><div class="value" id="mic-kpi-peak">— dB</div></div>
          <div class="stat"><div class="label">Clipping</div><div class="value" id="mic-kpi-clip">0</div></div>
          <div class="stat"><div class="label">Status</div><div class="value"><span id="mic-status" class="badge">Idle</span></div></div>
        </div>
        <div class="row" aria-label="Microphone level meter">
          <div class="meter" style="flex:1;min-width:220px"><div id="mic-meter" class="meter-fill" style="width:0%"></div></div>
        </div>
      </div>
      <div>
        <h3>Speakers</h3>
        <div class="row wrap device-row">
          <label for="spk-select">Output:</label>
          <select id="spk-select" class="device-select" aria-label="Select speakers"></select>
          <button id="spk-left">Left</button>
          <button id="spk-right">Right</button>
          <button id="spk-both">Both</button>
          <button id="spk-sweep" class="ghost">Stereo sweep</button>
          <button id="spk-stop" class="ghost" title="Stop playback">Stop</button>
        </div>
        <div class="row wrap">
          <label for="spk-volume">Volume:</label>
          <input id="spk-volume" type="range" min="0" max="1" step="0.01" value="0.5" style="width:200px" />
          <span class="muted" id="spk-status" role="status" aria-live="polite" style="margin-left:auto">Idle</span>
        </div>
        <p id="spk-note" class="muted" style="margin:8px 0 0"></p>
      </div>
    </div>
  </section>

  <!-- Keyboard Test -->
  <section class="card subtab-panel" id="panel-keyboard" role="tabpanel" aria-labelledby="tab-keyboard" hidden>
    <h2 id="keyboard-title">Keyboard</h2>
    <p class="muted">Press keys to verify detection. Modifiers and key codes are shown below.</p>
    <div id="keyboard-current" class="kbd-readout" aria-live="polite"></div>
    <div id="keyboard-pressed" class="kbd-keys" aria-label="Currently pressed keys"></div>
    <div class="row">
      <button id="keyboard-clear">Clear</button>
      <label><input type="checkbox" id="keyboard-capture" checked /> Capture keystrokes</label>
    </div>
  </section>

  <!-- Mouse / Trackpad Test -->
  <section class="card subtab-panel" id="panel-mouse" role="tabpanel" aria-labelledby="tab-mouse" hidden>
    <h2 id="mouse-title">Mouse / Trackpad</h2>
    <div class="mouse-kpis stat-grid">
      <div class="stat"><div class="label">Position</div><div class="value" id="mouse-pos">0, 0</div></div>
      <div class="stat"><div class="label">Buttons</div><div class="value"><span id="mouse-buttons">none</span>
        <span class="mouse-buttons-visual" aria-hidden="true">
          <span id="btn-left" class="mouse-btn" title="Left">L</span>
          <span id="btn-middle" class="mouse-btn" title="Middle">M</span>
          <span id="btn-right" class="mouse-btn" title="Right">R</span>
        </span>
      </div></div>
      <div class="stat"><div class="label">Wheel</div><div class="value"><span id="mouse-wheel">0</span>
        <div class="progress" style="margin-top:6px"><div id="mouse-wheel-bar" class="bar" style="width:50%"></div></div>
      </div></div>
      <div class="stat"><div class="label">Speed</div><div class="value" id="mouse-speed">0 px/s</div></div>
    </div>
    <div id="mouse-area" class="mouse-area" tabindex="0" aria-label="Mouse test area">
      <div class="mouse-area-hint">Click, move, and scroll here</div>
      <div id="cursor-dot" class="cursor-dot" hidden></div>
      <div id="coord-tag" class="coord-tag">0, 0</div>
    </div>
    <div class="row">
      <button id="dblclick-test">Double-click test</button>
      <span class="muted">Last double-click: <span id="dblclick-time">n/a</span> ms</span>
      <span id="dblclick-badge" class="badge" aria-hidden="true">n/a</span>
      <button id="mouse-reset" class="ghost" style="margin-left:auto">Reset</button>
    </div>
  </section>

  <!-- Network Test -->
  <section class="card subtab-panel" id="panel-network" role="tabpanel" aria-labelledby="tab-network" hidden>
    <h2 id="network-title">Network</h2>
    <div class="row">
      <button id="network-quick">Run quick test</button>
      <button id="network-extended" class="ghost">Run extended test</button>
      <span id="network-status" class="muted" role="status" aria-live="polite"></span>
    </div>
    <div class="row">
      <span>Overall:</span>
      <span id="network-health" class="badge">Unknown</span>
      <span id="network-summary" class="muted"></span>
    </div>
    <div class="net-kpis stat-grid">
      <div class="stat"><div class="label">Median latency</div><div class="value" id="net-kpi-med">—</div></div>
      <div class="stat"><div class="label">Avg latency</div><div class="value" id="net-kpi-avg">—</div></div>
      <div class="stat"><div class="label">Packet loss</div><div class="value" id="net-kpi-loss">—</div></div>
      <div class="stat"><div class="label">Throughput</div><div class="value" id="net-kpi-dl">—</div></div>
    </div>
    <div class="grid grid-2">
      <div>
        <h3>Info</h3>
        <ul id="network-info" class="list"></ul>
      </div>
      <div>
        <h3>Results</h3>
        <ul id="network-results" class="list"></ul>
      </div>
    </div>
  </section>

  <!-- Display Test -->
  <section class="card subtab-panel" id="panel-display" role="tabpanel" aria-labelledby="tab-display" hidden>
    <h2 id="display-title">Display</h2>
    <div class="row wrap">
      <button class="disp-color" data-color="#000000">Black</button>
      <button class="disp-color" data-color="#ffffff">White</button>
      <button class="disp-color" data-color="#ff0000">Red</button>
      <button class="disp-color" data-color="#00ff00">Green</button>
      <button class="disp-color" data-color="#0000ff">Blue</button>
      <button id="disp-gradient">Gradient</button>
      <button id="disp-checker">Checkerboard</button>
      <button id="disp-cycle">Cycle colors</button>
      <button id="disp-fullscreen">Toggle Fullscreen</button>
    </div>
    <div id="display-area" class="display-area" aria-label="Display test area"></div>
  </section>
</section>
